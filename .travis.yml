notifications:
  email:
    recipients:
      - rich@flatcap.org
      - gahr@gahr.ch
    on_success: change
    on_failure: always

sudo: false
dist: trusty

language: c
compiler: gcc
cache: ccache

addons:
  apt:
    packages:
      - libgpgme11-dev
      - libnotmuch-dev
      - libtokyocabinet-dev
      - libkyotocabinet-dev
      - libgdbm-dev
      - libdb-dev
      - liblmdb-dev
      - libqdbm-dev
      - libslang2-dev
      - libgnutls-dev
      - libssl-dev
      - libsasl2-dev
      - libgss-dev
      - xsltproc
      - lynx
      - docbook-simple
      - docbook-xsl
      - libxml2-utils
      - gettext
      - lua5.2
      - liblua5.2-dev
      - autopoint

git:
  depth: 3

install:
  - git clone --depth 1 https://github.com/neomutt/travis-build.git ~/config

before_script:
  - ccache --zero-stats

script:
  - ~/config/build
  - make distclean
  - ./configure.autosetup --everything && make
  - make distclean
  - ./configure.autosetup --gnutls --disable-doc --disable-nls && make
  - make distclean
  - ./configure.autosetup --with-ui=slang --disable-doc --disable-nls && make

after_script:
  - ccache --show-stats

